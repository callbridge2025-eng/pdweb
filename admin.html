<!DOCTYPE html>
<html>
<head>
<title>Admin Panel</title>
<link rel="stylesheet" href="assets/css/style.css">
<style>
body { background:#f5f5f5; }
.admin-container { width:90%; margin:50px auto; }
table {
  width:100%;
  border-collapse: collapse;
  background:#fff;
}
th, td {
  border:1px solid #ddd;
  padding:10px;
  font-size:14px;
}
th {
  background:#244a8f;
  color:#fff;
}
.login-box {
  max-width:400px;
  margin:100px auto;
  background:#fff;
  padding:30px;
  text-align:center;
}
</style>
</head>
<body>

<div id="loginSection" class="login-box">
  <h2>Admin Login</h2>
  <input type="password" id="adminPass" placeholder="Enter Password">
  <br><br>
  <button onclick="login()">Login</button>
</div>

<div id="adminSection" class="admin-container" style="display:none;">
  <h2>Loan Applications</h2>
  <table id="dataTable"></table>
</div>

<script>
async function login() {
  const password = document.getElementById("adminPass").value;

  const response = await fetch("/api/admin", {
    headers: {
      "Authorization": "Bearer " + password
    }
  });

  const result = await response.json();

  if(result.success){
    document.getElementById("loginSection").style.display = "none";
    document.getElementById("adminSection").style.display = "block";
    renderTable(result.data);
  } else {
    alert("Wrong password");
  }
}

function renderTable(data){
  const table = document.getElementById("dataTable");

  // CLEAR TABLE FIRST (important)
  table.innerHTML = "";

  data.forEach((row, index) => {
    const tr = document.createElement("tr");

    row.forEach(cell => {
      const td = document.createElement(index === 0 ? "th" : "td");
      td.textContent = cell;
      tr.appendChild(td);
    });

    table.appendChild(tr);
  });
}

</script>

</body>
</html>
